<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè∞ Fortress Vulnerability Management</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #0a0e27 0%, #1a1d3a 50%, #2d1b69 100%); color: #ffffff; min-height: 100vh; }
        .container { max-width: 1600px; margin: 0 auto; padding: 2rem; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .header h1 { font-size: 2.5rem; font-weight: 800; background: linear-gradient(135deg, #00d4ff, #7c3aed); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1.5rem; text-align: center; }
        .stat-value { font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem; }
        .critical { color: #ef4444; }
        .high { color: #f59e0b; }
        .medium { color: #3b82f6; }
        .low { color: #10b981; }
        .btn { background: linear-gradient(135deg, #00d4ff, #7c3aed); border: none; color: white; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; gap: 0.5rem; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0, 212, 255, 0.3); }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); }
        .btn-success { background: linear-gradient(135deg, #10b981, #059669); }
        .vuln-table { width: 100%; border-collapse: collapse; background: rgba(255, 255, 255, 0.02); border-radius: 12px; overflow: hidden; margin-bottom: 2rem; }
        .vuln-table th, .vuln-table td { text-align: left; padding: 1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .vuln-table th { background: rgba(255, 255, 255, 0.05); font-weight: 600; }
        .vuln-table tr:hover { background: rgba(255, 255, 255, 0.02); }
        .severity-badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }
        .severity-critical { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .severity-high { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
        .severity-medium { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .severity-low { background: rgba(16, 185, 129, 0.2); color: #10b981; }
        .status-badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }
        .status-open { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .status-patched { background: rgba(16, 185, 129, 0.2); color: #10b981; }
        .cvss-score { font-weight: 700; padding: 0.25rem 0.5rem; border-radius: 4px; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; align-items: center; justify-content: center; }
        .modal.show { display: flex; }
        .modal-content { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 2rem; max-width: 800px; width: 90%; max-height: 80vh; overflow-y: auto; }
        .chart-container { position: relative; height: 300px; margin: 1rem 0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-bug"></i> Vulnerability Management</h1>
            <div style="display: flex; gap: 1rem;">
                <button class="btn" onclick="startScan()">
                    <i class="fas fa-search"></i> Start Scan
                </button>
                <button class="btn btn-secondary" onclick="refreshVulns()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
            </div>
        </div>

        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value critical">23</div>
                <div class="stat-label">Critical CVEs</div>
            </div>
            <div class="stat-card">
                <div class="stat-value high">45</div>
                <div class="stat-label">High Severity</div>
            </div>
            <div class="stat-card">
                <div class="stat-value medium">67</div>
                <div class="stat-label">Medium Severity</div>
            </div>
            <div class="stat-card">
                <div class="stat-value low">89</div>
                <div class="stat-label">Low Severity</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: #10b981;">89%</div>
                <div class="stat-label">Patched</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: #00d4ff;">4.2</div>
                <div class="stat-label">Avg CVSS</div>
            </div>
        </div>

        <!-- Charts -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
            <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 12px;">
                <h3 style="margin-bottom: 1rem;">Vulnerability Trends</h3>
                <div class="chart-container">
                    <canvas id="trendsChart"></canvas>
                </div>
            </div>
            <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 12px;">
                <h3 style="margin-bottom: 1rem;">Severity Distribution</h3>
                <div class="chart-container">
                    <canvas id="severityChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Vulnerabilities Table -->
        <table class="vuln-table">
            <thead>
                <tr>
                    <th>CVE ID</th>
                    <th>Severity</th>
                    <th>CVSS Score</th>
                    <th>Package</th>
                    <th>Status</th>
                    <th>Age</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="vulnTableBody">
                <tr>
                    <td><strong>CVE-2024-1234</strong></td>
                    <td><span class="severity-badge severity-critical">
                        <i class="fas fa-exclamation-triangle"></i> CRITICAL
                    </span></td>
                    <td><span class="cvss-score" style="background: rgba(239, 68, 68, 0.3)">9.8</span></td>
                    <td>openssl</td>
                    <td><span class="status-badge status-open">
                        <i class="fas fa-times-circle"></i> OPEN
                    </span></td>
                    <td>15 days</td>
                    <td>
                        <button class="btn btn-secondary" onclick="viewDetails('CVE-2024-1234')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn btn-success" onclick="patchVuln('CVE-2024-1234')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-left: 0.25rem;">
                            <i class="fas fa-wrench"></i> Patch
                        </button>
                    </td>
                </tr>
                <tr>
                    <td><strong>CVE-2024-5678</strong></td>
                    <td><span class="severity-badge severity-high">
                        <i class="fas fa-exclamation-circle"></i> HIGH
                    </span></td>
                    <td><span class="cvss-score" style="background: rgba(245, 158, 11, 0.3)">8.2</span></td>
                    <td>nginx</td>
                    <td><span class="status-badge status-patched">
                        <i class="fas fa-check-circle"></i> PATCHED
                    </span></td>
                    <td>8 days</td>
                    <td>
                        <button class="btn btn-secondary" onclick="viewDetails('CVE-2024-5678')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                            <i class="fas fa-eye"></i> View
                        </button>
                    </td>
                </tr>
                <tr>
                    <td><strong>CVE-2024-9012</strong></td>
                    <td><span class="severity-badge severity-medium">
                        <i class="fas fa-info-circle"></i> MEDIUM
                    </span></td>
                    <td><span class="cvss-score" style="background: rgba(59, 130, 246, 0.3)">6.1</span></td>
                    <td>kubernetes</td>
                    <td><span class="status-badge status-open">
                        <i class="fas fa-times-circle"></i> OPEN
                    </span></td>
                    <td>22 days</td>
                    <td>
                        <button class="btn btn-secondary" onclick="viewDetails('CVE-2024-9012')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn btn-success" onclick="patchVuln('CVE-2024-9012')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-left: 0.25rem;">
                            <i class="fas fa-wrench"></i> Patch
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Vulnerability Details Modal -->
    <div id="vulnModal" class="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h2 id="vulnTitle">Vulnerability Details</h2>
                <button style="background: none; border: none; color: #ffffff; font-size: 1.5rem; cursor: pointer;" onclick="closeModal()">&times;</button>
            </div>
            <div id="vulnDetails">
                <!-- Details will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        function startScan() {
            alert('üîç Starting Vulnerability Scan\n\nScanning all containers and packages...\nThis may take several minutes to complete.\n\nScan results will be displayed when ready.');
        }

        function refreshVulns() {
            alert('‚úÖ Vulnerability data refreshed!\n\nLatest CVE database synchronized.\nAll vulnerability statuses updated.');
        }

        function viewDetails(cveId) {
            const details = {
                'CVE-2024-1234': {
                    description: 'Buffer overflow in OpenSSL certificate parsing',
                    impact: 'Remote code execution possible',
                    solution: 'Update to OpenSSL 1.1.1g or later',
                    systems: ['web-server-1', 'api-gateway', 'auth-service']
                },
                'CVE-2024-5678': {
                    description: 'HTTP request smuggling vulnerability in nginx',
                    impact: 'Potential for request smuggling attacks',
                    solution: 'Update to nginx 1.20.1 or apply security patch',
                    systems: ['web-server-1', 'load-balancer']
                },
                'CVE-2024-9012': {
                    description: 'Information disclosure in Kubernetes API server',
                    impact: 'Sensitive information may be exposed',
                    solution: 'Upgrade Kubernetes to 1.28.2 or implement network policies',
                    systems: ['kubernetes-master', 'api-server']
                }
            };

            const vuln = details[cveId];
            if (!vuln) return;

            document.getElementById('vulnTitle').textContent = cveId;
            document.getElementById('vulnDetails').innerHTML = `
                <div style="background: rgba(255, 255, 255, 0.02); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: #00d4ff; margin-bottom: 1rem;">Description</h4>
                    <p>${vuln.description}</p>
                </div>
                <div style="background: rgba(255, 255, 255, 0.02); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: #00d4ff; margin-bottom: 1rem;">Impact</h4>
                    <p>${vuln.impact}</p>
                </div>
                <div style="background: rgba(255, 255, 255, 0.02); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: #00d4ff; margin-bottom: 1rem;">Solution</h4>
                    <p>${vuln.solution}</p>
                </div>
                <div style="background: rgba(255, 255, 255, 0.02); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="color: #00d4ff; margin-bottom: 1rem;">Affected Systems</h4>
                    <ul>
                        ${vuln.systems.map(system => `<li>${system}</li>`).join('')}
                    </ul>
                </div>
                <div style="text-align: right;">
                    <button class="btn btn-secondary" onclick="closeModal()">Close</button>
                </div>
            `;

            document.getElementById('vulnModal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('vulnModal').classList.remove('show');
        }

        function patchVuln(cveId) {
            if (confirm(`Apply patch for ${cveId}?\n\nThis will update the affected package and restart services.\n\nContinue?`)) {
                alert(`‚úÖ Patch applied successfully!\n\n${cveId} has been patched.\nAll affected systems updated.`);
                
                // Update UI to show patched status
                const row = event.target.closest('tr');
                const statusCell = row.cells[4];
                statusCell.innerHTML = '<span class="status-badge status-patched"><i class="fas fa-check-circle"></i> PATCHED</span>';
                
                // Remove patch button
                const patchBtn = event.target;
                patchBtn.remove();
            }
        }

        // Initialize charts
        window.addEventListener('load', function() {
            // Trends Chart
            const trendsCtx = document.getElementById('trendsChart').getContext('2d');
            new Chart(trendsCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'New Vulnerabilities',
                        data: [45, 52, 38, 67, 43, 29],
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Patched',
                        data: [38, 48, 35, 61, 40, 28],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#ffffff' } } },
                    scales: {
                        x: { ticks: { color: '#ffffff' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#ffffff' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                    }
                }
            });

            // Severity Chart
            const severityCtx = document.getElementById('severityChart').getContext('2d');
            new Chart(severityCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Critical', 'High', 'Medium', 'Low'],
                    datasets: [{
                        data: [23, 45, 67, 89],
                        backgroundColor: ['#ef4444', '#f59e0b', '#3b82f6', '#10b981']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#ffffff' } } }
                }
            });
        });
    </script>
</body>
</html>
